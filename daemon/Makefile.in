################## Some of this may need to be edited ##################

prefix=@prefix@
exec_prefix=@exec_prefix@
SBINDIR=@sbindir@

COSIGNCONF=@cosignconf@
COSIGNDIR=@cosigndir@
COSIGNSYSLOG=LOG_LOCAL7

INCPATH=        @CPPFLAGS@ -I../libsnet
OPTOPTS=        @OPTOPTS@
CC=             @CC@
DEFS=           @TLSDEFS@
LIBS=           -lsnet @LIBS@
LDFLAGS=        -L../libsnet/.libs @LDFLAGS@ ${LIBS}
INSTALL=        @INSTALL@

CFLAGS=         ${DEFS} ${OPTOPTS} @CFLAGS@ ${INCPATH}

################ Nothing below should need editing ###################

SRC= daemon.c command.c argcargv.c cparse.c config.c fbase64.c mkcookie.c wildcard.c logname.c
COSIGNOBJ= daemon.o command.o argcargv.o cparse.o config.o fbase64.o mkcookie.o wildcard.o logname.o ../version.o

TARGETS=	cosignd

all : ${TARGETS}

daemon.o : daemon.c
	${CC} ${CFLAGS} \
	-D_COSIGN_CONF=\"${COSIGNCONF}\" \
	-D_COSIGN_DIR=\"${COSIGNDIR}\" \
	-D_COSIGN_LOG=${COSIGNSYSLOG} \
	-c daemon.c

cosignd : ../libsnet/libsnet.la ${COSIGNOBJ} Makefile
	${CC} ${CFLAGS} ${LDFLAGS} -o cosignd ${COSIGNOBJ} ${LIBPATH} ${LIBS}

install : all
	-mkdir -p ${exec_prefix}
	-mkdir -p ${SBINDIR}
	${INSTALL} -m 0755 -c cosignd ${SBINDIR}/

clean :
	rm -f a.out core* *.o *.bak *[Ee]rrs tags
	rm -f ${TARGETS}
